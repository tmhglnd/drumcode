#N canvas 827 239 527 327 12;
#X declare -path ~/Sync/work/projects/drumcode/pd;
#X declare -path FluidCorpusManipulation;
#X obj 59 139 adc~ 1;
#X obj 59 175 meter~;
#X obj 59 95 declare -path ~/Sync/work/projects/drumcode/pd;
#X obj 186 139 dc.audio.onoff~;
#X obj 59 59 declare -path FluidCorpusManipulation;
#X obj 174 349 dc.trigger~;
#X obj 194 315 hsl 128 17 0 1 0 0 empty empty empty -2 -8 0 10 #e4e4e4 #4d4d4d #373737 0 1;
#X msg 61 615 0;
#X obj 62 793 hsl 128 17 0 1 0 0 empty empty empty -2 -8 0 10 #e4e4e4 #4d4d4d #000000 0 1;
#X obj 175 577 array define \$0-loudness-stats;
#X obj 59 646 array get;
#X msg 98 615 symbol \$1;
#X obj 59 577 t b a;
#X obj 211 389 bng 25 250 50 0 empty empty empty 17 7 0 10 #e4e4e4 #4d4d4d #000000;
#X obj 59 758 dc.calibrate;
#X obj 198 697 tgl 25 0 empty empty empty 17 7 0 10 #e4e4e4 #4d4d4d #000000 0 1;
#X obj 59 389 dc.trigger.frame~ 256;
#X obj 304 943 array get;
#X msg 343 912 symbol \$1;
#X obj 304 874 t b a;
#X obj 304 646 fluid.bufpitch -numchans 1 - blocking 1 -fftsettings 256 64 512;
#X obj 416 858 array define \$0-pitch-stats;
#X msg 306 912 0;
#X obj 304 768 fluid.bufselect -channels 0;
#X obj 561 696 fluid.bufselect -channels 1;
#X text 581 719 use the pitch confidence channel of analysis as statistical weights. This makes analysis frames with higher pitch confidence worth more in the statistical analysis, f 27;
#X obj 304 679 t a a;
#X obj 304 829 fluid.bufstats -select mid -stats \$0-pitch-stats;
#X text 593 828 Using -select we extract only the "mid" statistic (by default this is the 50th percentile and therefore the median). This is a little more robust to outliers than the mean, f 29;
#X text 329 786 get the pitch (frequency) from the analysis, f 22;
#X text 334 482 get the loudness \, or the peak information. Needs some testing which performs more true to the real life sound;
#X text 370 569 gives more true readings than mean \, that can have a strange result due to outliers?, f 38;
#X obj 59 420 t a a a;
#X text 1194 549 spread -> Literally how flat your spectrum is. White noise occupies equal energy in each frequency bin of a spectral analysis and is therefore very flat. A single sinusoidal peak will be not flat at all. It might be useful for differentiating noisy and tonal sounds.;
#X text 1194 494 centroid -> Centroid is the centre of gravity or centre of mass in the spectrum. If you had to balance the spectrum on the tip of your finger \, where would you place it?;
#X floatatom 93 694 5 0 0 0 - - - 12;
#X obj 59 543 fluid.bufstats -select high -stats \$0-loudness-stats;
#X text 370 542 high percentile \, mid (50th percentile \, is the median) or mean?;
#X obj 59 460 fluid.bufloudness -truepeak 0 -numchans 1 -blocking 1 -select loudness -windowsize 256 -hopsize 64 -kweighting 0, f 99;
#X floatatom 304 977 5 0 0 0 - - - 12;
#X obj 931 809 array get;
#X msg 983 779 symbol \$1;
#X msg 933 778 0;
#X obj 862 625 fluid.bufflatten -destination \$0-spec-stats;
#X obj 950 659 array define \$0-spec-stats;
#X obj 1076 810 array get;
#X msg 1115 779 symbol \$1;
#X obj 1076 741 t b a;
#X floatatom 1076 844 8 0 0 0 - - - 16;
#X msg 1078 779 1;
#X obj 1201 733 array;
#X msg 955 774 2;
#X obj 931 740 t b b a;
#X obj 940 849 print;
#X obj 862 593 fluid.bufstats -select mean;
#X obj 862 421 fluid.bufspectralshape -numchans 1 -select centroid flatness -fftsettings 256 32 -1 -blocking 1, f 82;
#X obj 432 170 tgl 25 0 empty empty empty 17 7 0 10 #e4e4e4 #4d4d4d #000000 0 1;
#X obj 431 209 switch~;
#X connect 0 0 1 0;
#X connect 1 0 5 0;
#X connect 1 0 16 0;
#X connect 5 0 13 0;
#X connect 5 0 16 1;
#X connect 6 0 5 1;
#X connect 7 0 10 0;
#X connect 10 0 14 0;
#X connect 10 0 35 0;
#X connect 11 0 10 2;
#X connect 12 0 7 0;
#X connect 12 1 11 0;
#X connect 14 0 8 0;
#X connect 15 0 14 1;
#X connect 16 0 32 0;
#X connect 17 0 39 0;
#X connect 18 0 17 2;
#X connect 19 0 22 0;
#X connect 19 1 18 0;
#X connect 20 0 26 0;
#X connect 22 0 17 0;
#X connect 23 0 27 0;
#X connect 24 0 27 1;
#X connect 26 0 23 0;
#X connect 26 1 24 0;
#X connect 27 0 19 0;
#X connect 32 0 38 0;
#X connect 32 1 20 0;
#X connect 32 2 55 0;
#X connect 36 0 12 0;
#X connect 38 0 36 0;
#X connect 40 0 53 0;
#X connect 41 0 40 2;
#X connect 42 0 40 0;
#X connect 43 0 47 0;
#X connect 43 0 50 0;
#X connect 43 0 52 0;
#X connect 45 0 48 0;
#X connect 46 0 45 2;
#X connect 47 0 49 0;
#X connect 47 1 46 0;
#X connect 49 0 45 0;
#X connect 51 0 40 1;
#X connect 52 0 42 0;
#X connect 52 1 51 0;
#X connect 52 2 41 0;
#X connect 54 0 43 0;
#X connect 55 0 54 0;
#X connect 56 0 57 0;
