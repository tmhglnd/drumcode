#N canvas 827 239 734 565 12;
#X declare -path drumcode/pd;
#X declare -path cyclone;
#X declare -path else;
#X obj 160 374 timer;
#X obj 63 242 t b b b;
#X text 202 418 if larger than half quantize time trigger 1 for next beat, f 20;
#X obj 160 419 >;
#X floatatom 238 249 5 0 0 0 - - - 12;
#X obj 238 279 !/ 240000;
#X obj 238 375 / 2;
#X obj 238 316 pak f 16;
#X obj 238 343 / 1;
#X obj 124 580 int 0;
#X msg 163 531 1;
#X obj 111 500 t b b;
#X msg 113 531 0;
#X obj 160 500 sel 1 0;
#X obj 348 541 t f f;
#X obj 38 867 zl.reg;
#X obj 124 820 t l l;
#X obj 38 759 buddy;
#X obj 539 679 declare -path drumcode/pd;
#X obj 176 41 inlet (trigger) input a trigger from dc.trigger~ or dc.trigger.velocity~;
#X obj 539 712 declare -path cyclone;
#X obj 540 746 declare -path else;
#X obj 539 113 args -;
#X obj 539 146 route -name;
#X obj 539 79 loadbang;
#X obj 259 79 inlet (number) subdivision quantization for pattern detection (default = 16), f 34;
#N canvas 733 172 450 300 fill-array-0 0;
#X obj 594 573 uzi;
#X msg 596 601 0;
#X obj 594 629 zl.group;
#X text 632 601 init with empty array;
#X obj 434 537 inlet;
#X obj 316 658 outlet;
#X connect 0 0 1 0;
#X connect 0 1 2 0;
#X connect 1 0 2 0;
#X connect 2 0 5 0;
#X connect 4 0 0 0;
#X restore 359 576 pd fill-array-0;
#X obj 135 867 outlet (list) rolling detected quantized pattern;
#X obj 38 906 outlet (list) detected quantized pattern every bar;
#N canvas 733 172 450 300 join-replace 0;
#X obj 79 200 zl.slice 16;
#X obj 79 157 zl.join;
#X text 259 304 set previous to 1 if trigger was detected after the beat, f 18;
#X obj 179 261 zl.reg;
#X obj 179 305 replace 1 1;
#X obj 79 350 zl.rev;
#X obj 79 71 inlet;
#X obj 237 71 inlet;
#X obj 297 71 inlet;
#X obj 179 71 inlet;
#X obj 79 384 outlet;
#X connect 0 0 3 1;
#X connect 0 0 5 0;
#X connect 0 0 1 1 48.................J....X9+++uB....l++++q6+++eE....59+++WA...vv++++;
#X connect 1 0 0 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 4 0 1 1 48.................M....P9+++eC....j++++G0+++ur++++Q8+++K6+++uV++++;
#X connect 5 0 10 0;
#X connect 6 0 1 0;
#X connect 7 0 0 0;
#X connect 8 0 0 1;
#X connect 9 0 3 0;
#X restore 124 621 pd join-replace;
#X obj 259 127 t f f;
#X obj 348 485 inlet (number) list output length (default = quantization subdiv), f 28;
#X obj 658 182 unjoin 2;
#X obj 63 199 dc.metronome 16;
#X obj 63 127 r \$0-quant;
#X obj 658 211 s \$0-quant;
#X obj 674 240 s \$0-len;
#X obj 398 541 r \$0-len;
#X obj 38 679 dc.metronome 1;
#X text 293 233 get BPM from global or named transport, f 18;
#X text 218 499 set step to 1 if trigger detected before the next hit, f 17;
#X obj 539 218 s \$0-name;
#X obj 38 643 r \$0-name;
#X obj 539 182 prepend -name;
#X obj 38 791 t b;
#X obj 38 723 delay;
#X obj 163 694 blocksize~;
#X obj 163 662 loadbang;
#X obj 163 723 samps2ms;
#X text 250 693 short delay to compensate for clicktrack audio latency output, f 19;
#X connect 0 0 3 0;
#X connect 1 0 17 1;
#X connect 1 1 11 0;
#X connect 1 2 0 0;
#X connect 3 0 13 0;
#X connect 4 0 5 0;
#X connect 5 0 7 0;
#X connect 6 0 3 1;
#X connect 7 0 8 0;
#X connect 8 0 6 0;
#X connect 9 0 29 0;
#X connect 10 0 9 1;
#X connect 11 0 12 0;
#X connect 11 1 9 0;
#X connect 12 0 9 1;
#X connect 13 0 10 0;
#X connect 13 1 29 1;
#X connect 14 0 29 3;
#X connect 14 1 26 0;
#X connect 15 0 28 0;
#X connect 16 0 15 1;
#X connect 16 1 27 0;
#X connect 17 0 44 0;
#X connect 19 0 0 1;
#X connect 22 0 23 0;
#X connect 23 0 43 0;
#X connect 23 1 32 0;
#X connect 24 0 22 0;
#X connect 25 0 30 0;
#X connect 26 0 29 2;
#X connect 29 0 16 0;
#X connect 30 0 33 0;
#X connect 30 1 7 1;
#X connect 31 0 14 0;
#X connect 32 0 35 0;
#X connect 32 1 36 0;
#X connect 33 0 1 0;
#X connect 34 0 33 0;
#X connect 37 0 14 0;
#X connect 38 0 45 0;
#X connect 42 0 38 0;
#X connect 43 0 33 0;
#X connect 43 0 41 0;
#X connect 44 0 15 0;
#X connect 45 0 17 0;
#X connect 46 0 48 0;
#X connect 47 0 46 0;
#X connect 48 0 45 1;
